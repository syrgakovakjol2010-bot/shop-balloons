<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Element_gas_kg</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            /* === –ù–ê–°–¢–†–û–ô–ö–ò –¶–í–ï–¢–ê === */
            --neon-pink: #ff33ff;   /* –Ø—Ä–∫–∏–π —Ä–æ–∑–æ–≤—ã–π –Ω–µ–æ–Ω –¥–ª—è –∞–∫—Ü–µ–Ω—Ç–æ–≤ */
            --text-main: #ffffff;   /* –ë–µ–ª—ã–π —Ç–µ–∫—Å—Ç */
            --text-sec: #ffccff;    /* –°–≤–µ—Ç–ª–æ-—Ä–æ–∑–æ–≤—ã–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç */
            --input-bg: #2a0a35;    /* –§–æ–Ω –¥–ª—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ (–Ω–∞ —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–º —Ñ–æ–Ω–µ) */
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, Roboto, sans-serif;
            margin: 0; padding: 16px;
            -webkit-tap-highlight-color: transparent;
            min-height: 100vh;
            color: var(--text-main);
            
            /* –§–û–ù - –ì–õ–£–ë–û–ö–ò–ô –§–ò–û–õ–ï–¢–û–í–´–ô (–ê–ù–ò–ú–ò–†–û–í–ê–ù–ù–´–ô) */
            background: linear-gradient(-45deg, #1a0033, #330066, #4a0080, #220044);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        h2 {
            text-align: center; margin-bottom: 25px; text-transform: uppercase;
            letter-spacing: 2px; color: #fff;
            text-shadow: 0 0 15px var(--neon-pink);
        }

        /* === –†–û–ó–û–í–´–ï –ö–í–ê–î–†–ê–¢–ò–ö–ò (–ö–ê–†–¢–û–ß–ö–ò) === */
        .product-card {
            /* –†–æ–∑–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è —Å–∞–º–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ */
            background: linear-gradient(135deg, #d100d1, #a300a3);
            border: 2px solid #ff66ff; /* –°–≤–µ—Ç–ª–æ-—Ä–æ–∑–æ–≤–∞—è —Ä–∞–º–∫–∞ */
            border-radius: 20px;
            padding: 16px;
            margin-bottom: 18px;
            /* –ú–æ—â–Ω–æ–µ —Ä–æ–∑–æ–≤–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ */
            box-shadow: 0 5px 25px rgba(255, 0, 255, 0.4); 
            transition: transform 0.2s;
        }
        
        .product-header { display: flex; justify-content: space-between; margin-bottom: 12px; align-items: center; }
        /* –¢–µ–∫—Å—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ –≤–Ω—É—Ç—Ä–∏ —Ä–æ–∑–æ–≤–æ–π –∫–∞—Ä—Ç—ã */
        .product-title { font-size: 20px; font-weight: 900; color: #fff; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
        
        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ —É–≥–ª—É */
        .product-info { 
            color: #ffccff; /* –°–≤–µ—Ç–ª–æ-—Ä–æ–∑–æ–≤—ã–π */
            font-size: 13px; font-weight: 700; letter-spacing: 0.5px; 
            text-align: right; max-width: 50%;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }
        
        /* –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ (–¥–µ–ª–∞–µ–º —Ç–µ–º–Ω–µ–µ –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞ —Å —Ä–æ–∑–æ–≤—ã–º —Ñ–æ–Ω–æ–º) */
        .price-option {
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(0, 0, 0, 0.3); /* –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —á–µ—Ä–Ω—ã–π */
            padding: 12px; border-radius: 12px;
            margin-bottom: 8px; cursor: pointer; 
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: 0.3s;
        }
        
        .price-option.selected {
            border-color: #fff;
            background: rgba(255, 255, 255, 0.25); /* –°–≤–µ—Ç–ª–µ–µ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ */
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.4);
        }
        
        .price-text { font-weight: 700; color: #fff; }
        .option-label { font-size: 13px; color: #ffccff; }

        /* –°—á–µ—Ç—á–∏–∫–∏ */
        .counter-controls {
            display: flex; align-items: center; gap: 10px;
            background: rgba(0, 0, 0, 0.2); border: 2px solid #fff;
            border-radius: 10px; padding: 4px 8px;
        }
        .ctrl-btn { 
            background: transparent; border: none; 
            color: #fff; font-size: 22px; font-weight: bold;
            width: 30px; cursor: pointer; padding: 0;
        }
        .count-val { font-weight: bold; color: #fff; min-width: 20px; text-align: center;}
        .hidden { display: none !important; }

        /* === –≠–ö–†–ê–ù –û–§–û–†–ú–õ–ï–ù–ò–Ø (–ù–ê –§–ò–û–õ–ï–¢–û–í–û–ú –§–û–ù–ï) === */
        #order-screen { display: none; }
        
        /* –ü–æ–ª—è –≤–≤–æ–¥–∞ –Ω–∞ —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–º —Ñ–æ–Ω–µ */
        input, select {
            width: 100%; box-sizing: border-box; 
            background: var(--input-bg); /* –¢–µ–º–Ω–æ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π —Ñ–æ–Ω –ø–æ–ª–µ–π */
            border: 2px solid #5a007a; 
            color: white; 
            padding: 14px; border-radius: 12px;
            margin-bottom: 15px; font-size: 16px; outline: none; transition: 0.3s;
        }
        input:focus, select:focus { 
            border-color: var(--neon-pink); 
            box-shadow: 0 0 15px rgba(255, 51, 255, 0.5);
        }
        
        label { color: var(--text-sec); font-size: 13px; margin-bottom: 6px; display: block; margin-left: 4px;}
        .back-link { 
            color: var(--neon-pink); text-decoration: none; 
            font-size: 16px; display: inline-flex; align-items: center; 
            margin-bottom: 20px; font-weight: bold; text-shadow: 0 0 10px var(--neon-pink);
        }

        .radio-group { display: flex; gap: 10px; margin-bottom: 15px; }
        .radio-label {
            flex: 1; text-align: center; background: var(--input-bg);
            padding: 12px; border-radius: 12px; border: 2px solid #5a007a; 
            cursor: pointer; transition: 0.3s; color: var(--text-sec);
        }
        input[type="radio"] { display: none; }
        
        input[type="radio"]:checked + .radio-label {
            background: var(--neon-pink); border-color: var(--neon-pink); 
            color: #fff; font-weight: 900;
            box-shadow: 0 0 25px rgba(255, 51, 255, 0.7);
        }

        /* –ì–õ–ê–í–ù–ê–Ø –ö–ù–û–ü–ö–ê */
        .main-btn {
            width: calc(100% - 32px); padding: 18px;
            background: linear-gradient(to right, #ff00cc, #ff33ff); /* –†–æ–∑–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç */
            color: #fff;
            border: none; border-radius: 16px;
            font-size: 20px; font-weight: 900; text-transform: uppercase; letter-spacing: 1px;
            position: fixed; bottom: 20px; left: 16px;
            box-shadow: 0 5px 30px rgba(255, 0, 204, 0.6);
            z-index: 100; transition: transform 0.1s;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }
        .main-btn:active { transform: scale(0.96); }
    </style>
</head>
<body>

<div id="catalog-screen">
    <h2>Element_gas_kg</h2>
    <div id="products-container"></div>
    <div style="height: 100px;"></div>
</div>

<div id="order-screen">
    <a href="#" class="back-link" onclick="showCatalog()">‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –∫–∞—Ç–∞–ª–æ–≥</a>
    
    <label>–ì–æ—Ä–æ–¥ –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
    <select id="city">
        <option value="–ë–∏—à–∫–µ–∫">–ë–∏—à–∫–µ–∫</option>
        <option value="–û—à">–û—à</option>
        <option value="–ú–∞–Ω–∞—Å">–ú–∞–Ω–∞—Å</option>
    </select>

    <label>–ê–¥—Ä–µ—Å (–£–ª–∏—Ü–∞, –¥–æ–º):</label>
    <input type="text" id="address" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —É–ª. –¢–æ–∫—Ç–æ–≥—É–ª–∞, 125">

    <label>–ö–≤–∞—Ä—Ç–∏—Ä–∞ / –≠—Ç–∞–∂:</label>
    <input type="text" id="kv" placeholder="–ö–≤ 15, —ç—Ç–∞–∂ 3">

    <label>–¢–µ–ª–µ—Ñ–æ–Ω:</label>
    <input type="tel" id="phone" placeholder="0555 123 456">

    <label>–°—Ä–æ—á–Ω–æ—Å—Ç—å:</label>
    <div class="radio-group">
        <label style="flex:1">
            <input type="radio" name="urgency" value="–°—Ä–æ—á–Ω–æ!" checked>
            <div class="radio-label">üî• –°–†–û–ß–ù–û</div>
        </label>
        <label style="flex:1">
            <input type="radio" name="urgency" value="–ü–æ–¥–æ–∂–¥—É">
            <div class="radio-label">üê¢ –ü–æ–¥–æ–∂–¥—É</div>
        </label>
    </div>

    <label>–û–ø–ª–∞—Ç–∞:</label>
    <div class="radio-group">
        <label style="flex:1">
            <input type="radio" name="payment" value="–ù–∞–ª–∏—á–Ω—ã–µ" checked>
            <div class="radio-label">üíµ –ù–∞–ª–∏—á–Ω—ã–µ</div>
        </label>
        <label style="flex:1">
            <input type="radio" name="payment" value="–ü–µ—Ä–µ–≤–æ–¥">
            <div class="radio-label">üí≥ –ü–µ—Ä–µ–≤–æ–¥</div>
        </label>
    </div>

    <div style="height: 100px;"></div>
</div>

<button id="main-button" class="main-btn hidden" onclick="handleMainButton()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();
    // –¶–≤–µ—Ç —à–∞–ø–∫–∏ –ø–æ–¥ –Ω–æ–≤—ã–π —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π —Ñ–æ–Ω
    tg.setHeaderColor('#1a0033'); 
    tg.setBackgroundColor('#1a0033');

    function formatPrice(price) {
        return price.toLocaleString('ru-RU');
    }

    const products = [
        { id: 1, name: "10 –ª", info: "200-220 –º–∞–ª–µ–Ω—å–∫–∏—Ö —à–∞—Ä–æ–≤", priceFull: 18500, priceSwap: 15500 },
        { id: 2, name: "5 –ª", info: "120-130 –º–∞–ª–µ–Ω—å–∫–∏—Ö —à–∞—Ä–æ–≤", priceFull: 15000, priceSwap: 12000 },
        { id: 3, name: "4 –ª", info: "90-100 –º–∞–ª–µ–Ω—å–∫–∏—Ö —à–∞—Ä–æ–≤", priceFull: 13000, priceSwap: 10000 },
        { id: 4, name: "3.5 –ª", info: "20-25 –º–∞–ª–µ–Ω—å–∫–∏—Ö —à–∞—Ä–æ–≤", priceFull: 7300, priceSwap: 4300 },
        { id: 5, name: "2 –ª", info: "40-45 –º–∞–ª–µ–Ω—å–∫–∏—Ö —à–∞—Ä–æ–≤", priceFull: 9000, priceSwap: 6000 },
        { id: 6, name: "1 –ª", info: "20-25 –º–∞–ª–µ–Ω—å–∫–∏—Ö —à–∞—Ä–æ–≤", priceFull: 7500, priceSwap: 4500 }
    ];

    let cart = {};
    let currentScreen = 'catalog';
    const container = document.getElementById('products-container');

    products.forEach(p => {
        const el = document.createElement('div');
        el.className = 'product-card';
        el.innerHTML = `
            <div class="product-header">
                <span class="product-title">${p.name}</span>
                <span class="product-info">${p.info}</span>
            </div>
            ${renderOption(p.id, 'full', '–° –±–∞–ª–ª–æ–Ω–æ–º', p.priceFull)}
            ${renderOption(p.id, 'swap', '–° –∑–∞–º–µ–Ω–æ–π –±–∞–ª–ª–æ–Ω–∞', p.priceSwap)}
        `;
        container.appendChild(el);
    });

    function renderOption(id, type, label, price) {
        return `
        <div class="price-option" id="opt-${id}-${type}" onclick="addToCart(${id}, '${type}', ${price})">
            <div>
                <span class="option-label" style="display:block;">${label}</span>
                <span class="price-text">${formatPrice(price)} —Å</span>
            </div>
            <div id="ctrl-${id}-${type}" class="counter-controls hidden">
                <button class="ctrl-btn" onclick="event.stopPropagation(); minus(${id}, '${type}')">-</button>
                <span class="count-val" id="val-${id}-${type}">0</span>
                <button class="ctrl-btn" onclick="event.stopPropagation(); plus(${id}, '${type}')">+</button>
            </div>
        </div>`;
    }

    function addToCart(id, type, price) {
        const key = `${id}-${type}`;
        if (!cart[key]) cart[key] = { count: 0, price: price, id: id, type: type };
        plus(id, type);
    }

    function plus(id, type) {
        const key = `${id}-${type}`;
        if (cart[key]) cart[key].count++;
        updateUI();
    }

    function minus(id, type) {
        const key = `${id}-${type}`;
        if (cart[key]) {
            cart[key].count--;
            if (cart[key].count <= 0) delete cart[key];
        }
        updateUI();
    }

    function updateUI() {
        let totalSum = 0;
        let totalCount = 0;

        document.querySelectorAll('.price-option').forEach(el => el.classList.remove('selected'));
        document.querySelectorAll('.counter-controls').forEach(el => el.classList.add('hidden'));

        for (let key in cart) {
            const item = cart[key];
            totalSum += item.price * item.count;
            totalCount += item.count;
            
            const optDiv = document.getElementById(`opt-${item.id}-${item.type}`);
            if (optDiv) optDiv.classList.add('selected');

            const ctrl = document.getElementById(`ctrl-${key}`);
            const val = document.getElementById(`val-${key}`);
            if (ctrl) {
                ctrl.classList.remove('hidden');
                val.innerText = item.count;
            }
        }

        const btn = document.getElementById('main-button');
        if (totalCount > 0) {
            btn.classList.remove('hidden');
            btn.innerText = currentScreen === 'catalog' 
                ? `–û–§–û–†–ú–ò–¢–¨ (${formatPrice(totalSum)} —Å)` 
                : `–ü–û–î–¢–í–ï–†–î–ò–¢–¨ (${formatPrice(totalSum)} —Å)`;
        } else {
            btn.classList.add('hidden');
        }
    }

    function handleMainButton() {
        if (currentScreen === 'catalog') showOrderForm();
        else sendDataToBot();
    }

    function showOrderForm() {
        document.getElementById('catalog-screen').style.display = 'none';
        document.getElementById('order-screen').style.display = 'block';
        currentScreen = 'order';
        window.scrollTo(0,0);
        updateUI();
    }

    function showCatalog() {
        document.getElementById('catalog-screen').style.display = 'block';
        document.getElementById('order-screen').style.display = 'none';
        currentScreen = 'catalog';
        updateUI();
    }

    function sendDataToBot() {
        const address = document.getElementById('address').value;
        const phone = document.getElementById('phone').value;
        const kv = document.getElementById('kv').value;
        
        if (!address || !phone) {
            tg.showAlert("‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –∏ —Ç–µ–ª–µ—Ñ–æ–Ω!");
            return;
        }

        let items = [];
        let total = 0;
        for (let key in cart) {
            const i = cart[key];
            const p = products.find(x => x.id == i.id);
            const tName = i.type === 'full' ? '–° –±–∞–ª–ª–æ–Ω–æ–º' : '–° –∑–∞–º–µ–Ω–æ–π –±–∞–ª–ª–æ–Ω–∞';
            items.push({ name: `${p.name} (${tName})`, count: i.count });
            total += i.price * i.count;
        }

        const data = {
            city: document.getElementById('city').value,
            address: address,
            kv: kv,
            phone: phone,
            urgency: document.querySelector('input[name="urgency"]:checked').value,
            payment: document.querySelector('input[name="payment"]:checked').value,
            items: items,
            total: total
        };

        tg.sendData(JSON.stringify(data));
    }
</script>
</body>
</html>
