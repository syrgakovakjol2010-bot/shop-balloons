<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Element_gas_kg</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            /* === –ù–ê–°–¢–†–û–ô–ö–ò –¶–í–ï–¢–ê (–°–ò–ù–ò–ô –ù–ï–û–ù) === */
            --neon-color: #00e5ff;  /* –Ø—Ä–∫–æ-–≥–æ–ª—É–±–æ–π –Ω–µ–æ–Ω */
            --bg-color: #050505;    /* –ß–µ—Ä–Ω—ã–π —Ñ–æ–Ω */
            --card-bg: #101010;     /* –§–æ–Ω –∫–∞—Ä—Ç–æ—á–µ–∫ */
            --text-main: #ffffff;
            --text-sec: #8899a6;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: -apple-system, BlinkMacSystemFont, Roboto, sans-serif;
            margin: 0; padding: 16px;
            -webkit-tap-highlight-color: transparent;
            background-image: radial-gradient(circle at 50% 0%, #001f3f 0%, #050505 70%);
            min-height: 100vh;
        }
        
        /* –ó–ê–ì–û–õ–û–í–û–ö */
        h2 {
            text-align: center;
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #fff;
            text-shadow: 0 0 10px var(--neon-color); /* –ù–µ–æ–Ω–æ–≤–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ */
        }

        /* –ö–ê–†–¢–û–ß–ö–ê –¢–û–í–ê–†–ê */
        .product-card {
            background: var(--card-bg);
            border: 1px solid #333;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 0 15px rgba(0, 229, 255, 0.1); 
            transition: transform 0.2s;
        }
        
        .product-header { display: flex; justify-content: space-between; margin-bottom: 12px; align-items: center; }
        .product-title { font-size: 19px; font-weight: 800; color: #fff; }
        .product-info { color: var(--neon-color); font-size: 13px; font-weight: 600; letter-spacing: 0.5px; }
        
        /* –û–ü–¶–ò–ò */
        .price-option {
            display: flex; justify-content: space-between; align-items: center;
            background: #181818; padding: 12px; border-radius: 12px;
            margin-bottom: 8px; cursor: pointer;
            border: 1px solid #333;
            transition: 0.3s;
        }
        
        .price-option.selected {
            border-color: var(--neon-color);
            background: rgba(0, 229, 255, 0.08);
            box-shadow: 0 0 12px rgba(0, 229, 255, 0.2);
        }
        
        .price-text { font-weight: 700; color: #fff; }
        .option-label { font-size: 13px; color: var(--text-sec); }

        /* –°–ß–ï–¢–ß–ò–ö */
        .counter-controls {
            display: flex; align-items: center; gap: 10px;
            background: rgba(0, 229, 255, 0.1);
            border: 1px solid var(--neon-color);
            border-radius: 8px; padding: 4px 8px;
        }
        .ctrl-btn { 
            background: transparent; border: none; 
            color: var(--neon-color); font-size: 20px; font-weight: bold;
            width: 30px; cursor: pointer; padding: 0;
        }
        .count-val { font-weight: bold; color: #fff; min-width: 20px; text-align: center;}
        .hidden { display: none !important; }

        /* –ü–û–õ–Ø –í–í–û–î–ê */
        #order-screen { display: none; }
        input, select {
            width: 100%; box-sizing: border-box;
            background: #181818; 
            border: 1px solid #333; color: white; 
            padding: 14px; border-radius: 12px;
            margin-bottom: 15px; font-size: 16px; outline: none;
            transition: 0.3s;
        }
        input:focus, select:focus { 
            border-color: var(--neon-color); 
            box-shadow: 0 0 12px rgba(0, 229, 255, 0.3);
        }
        
        label { color: var(--text-sec); font-size: 13px; margin-bottom: 6px; display: block; margin-left: 4px;}
        .back-link { 
            color: var(--neon-color); text-decoration: none; 
            font-size: 16px; display: inline-flex; align-items: center; 
            margin-bottom: 20px; font-weight: bold; 
        }

        /* –†–ê–î–ò–û –ö–ù–û–ü–ö–ò */
        .radio-group { display: flex; gap: 10px; margin-bottom: 15px; }
        .radio-label {
            flex: 1; text-align: center; background: #181818;
            padding: 12px; border-radius: 12px; border: 1px solid #333; 
            cursor: pointer; transition: 0.3s; color: var(--text-sec);
        }
        input[type="radio"] { display: none; }
        
        input[type="radio"]:checked + .radio-label {
            background: var(--neon-color); 
            border-color: var(--neon-color); 
            color: #000; font-weight: 800;
            box-shadow: 0 0 15px rgba(0, 229, 255, 0.5);
        }

        /* –ö–ù–û–ü–ö–ê –ó–ê–ö–ê–ó–ê */
        .main-btn {
            width: calc(100% - 32px); padding: 18px;
            background: var(--neon-color); 
            color: #000;
            border: none; border-radius: 14px;
            font-size: 18px; font-weight: 900; text-transform: uppercase; letter-spacing: 1px;
            position: fixed; bottom: 20px; left: 16px;
            box-shadow: 0 0 25px rgba(0, 229, 255, 0.4);
            z-index: 100;
            transition: transform 0.1s;
        }
        .main-btn:active { transform: scale(0.96); }
    </style>
</head>
<body>

<div id="catalog-screen">
    <h2>Element_gas_kg</h2>
    <div id="products-container"></div>
    <div style="height: 100px;"></div>
</div>

<div id="order-screen">
    <a href="#" class="back-link" onclick="showCatalog()">‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –∫–∞—Ç–∞–ª–æ–≥</a>
    
    <label>–ì–æ—Ä–æ–¥ –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
    <select id="city">
        <option value="–ë–∏—à–∫–µ–∫">–ë–∏—à–∫–µ–∫</option>
        <option value="–û—à">–û—à</option>
        <option value="–ú–∞–Ω–∞—Å">–ú–∞–Ω–∞—Å</option>
    </select>

    <label>–ê–¥—Ä–µ—Å (–£–ª–∏—Ü–∞, –¥–æ–º):</label>
    <input type="text" id="address" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —É–ª. –¢–æ–∫—Ç–æ–≥—É–ª–∞, 125">

    <label>–ö–≤–∞—Ä—Ç–∏—Ä–∞ / –≠—Ç–∞–∂:</label>
    <input type="text" id="kv" placeholder="–ö–≤ 15, —ç—Ç–∞–∂ 3">

    <label>–¢–µ–ª–µ—Ñ–æ–Ω:</label>
    <input type="tel" id="phone" placeholder="0555 123 456">

    <label>–°—Ä–æ—á–Ω–æ—Å—Ç—å:</label>
    <div class="radio-group">
        <label style="flex:1">
            <input type="radio" name="urgency" value="–°—Ä–æ—á–Ω–æ!" checked>
            <div class="radio-label">üî• –°–†–û–ß–ù–û</div>
        </label>
        <label style="flex:1">
            <input type="radio" name="urgency" value="–ü–æ–¥–æ–∂–¥—É">
            <div class="radio-label">üê¢ –ü–æ–¥–æ–∂–¥—É</div>
        </label>
    </div>

    <label>–û–ø–ª–∞—Ç–∞:</label>
    <div class="radio-group">
        <label style="flex:1">
            <input type="radio" name="payment" value="–ù–∞–ª–∏—á–Ω—ã–µ" checked>
            <div class="radio-label">üíµ –ù–∞–ª–∏—á–Ω—ã–µ</div>
        </label>
        <label style="flex:1">
            <input type="radio" name="payment" value="–ü–µ—Ä–µ–≤–æ–¥">
            <div class="radio-label">üí≥ –ü–µ—Ä–µ–≤–æ–¥</div>
        </label>
    </div>

    <div style="height: 100px;"></div>
</div>

<button id="main-button" class="main-btn hidden" onclick="handleMainButton()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();
    tg.setHeaderColor('#050505'); 
    tg.setBackgroundColor('#050505');

    const products = [
        { id: 1, name: "10 –ª", info: "200-220 —à–∞—Ä–æ–≤", priceFull: 18 500, priceSwap: 15 500 },
        { id: 2, name: "5 –ª", info: "120-130 —à–∞—Ä–æ–≤", priceFull: 15 000, priceSwap: 12 000 },
        { id: 3, name: "4 –ª", info: "90-100 —à–∞—Ä–æ–≤", priceFull: 13 000, priceSwap: 10 000 },
        { id: 4, name: "3.5 –ª", info: "20-25 —à–∞—Ä–æ–≤", priceFull: 7300, priceSwap: 4300 },
        { id: 5, name: "2 –ª", info: "40-45 —à–∞—Ä–æ–≤", priceFull: 9000, priceSwap: 6000 },
        { id: 6, name: "1 –ª", info: "20-25 —à–∞—Ä–æ–≤", priceFull: 7500, priceSwap: 4500 }
    ];

    let cart = {};
    let currentScreen = 'catalog';
    const container = document.getElementById('products-container');

    products.forEach(p => {
        const el = document.createElement('div');
        el.className = 'product-card';
        el.innerHTML = `
            <div class="product-header">
                <span class="product-title">${p.name}</span>
                <span class="product-info">${p.info}</span>
            </div>
            ${renderOption(p.id, 'full', '–° –±–∞–ª–ª–æ–Ω–æ–º', p.priceFull)}
            ${renderOption(p.id, 'swap', '–° –∑–∞–º–µ–Ω–æ–π –±–∞–ª–ª–æ–Ω–∞', p.priceSwap)}
        `;
        container.appendChild(el);
    });

    function renderOption(id, type, label, price) {
        return `
        <div class="price-option" id="opt-${id}-${type}" onclick="addToCart(${id}, '${type}', ${price})">
            <div>
                <span class="option-label" style="display:block;">${label}</span>
                <span class="price-text">${price} —Å</span>
            </div>
            <div id="ctrl-${id}-${type}" class="counter-controls hidden">
                <button class="ctrl-btn" onclick="event.stopPropagation(); minus(${id}, '${type}')">-</button>
                <span class="count-val" id="val-${id}-${type}">0</span>
                <button class="ctrl-btn" onclick="event.stopPropagation(); plus(${id}, '${type}')">+</button>
            </div>
        </div>`;
    }

    function addToCart(id, type, price) {
        const key = `${id}-${type}`;
        if (!cart[key]) cart[key] = { count: 0, price: price, id: id, type: type };
        plus(id, type);
    }

    function plus(id, type) {
        const key = `${id}-${type}`;
        if (cart[key]) cart[key].count++;
        updateUI();
    }

    function minus(id, type) {
        const key = `${id}-${type}`;
        if (cart[key]) {
            cart[key].count--;
            if (cart[key].count <= 0) delete cart[key];
        }
        updateUI();
    }

    function updateUI() {
        let totalSum = 0;
        let totalCount = 0;

        document.querySelectorAll('.price-option').forEach(el => el.classList.remove('selected'));
        document.querySelectorAll('.counter-controls').forEach(el => el.classList.add('hidden'));

        for (let key in cart) {
            const item = cart[key];
            totalSum += item.price * item.count;
            totalCount += item.count;
            
            const optDiv = document.getElementById(`opt-${item.id}-${item.type}`);
            if (optDiv) optDiv.classList.add('selected');

            const ctrl = document.getElementById(`ctrl-${key}`);
            const val = document.getElementById(`val-${key}`);
            if (ctrl) {
                ctrl.classList.remove('hidden');
                val.innerText = item.count;
            }
        }

        const btn = document.getElementById('main-button');
        if (totalCount > 0) {
            btn.classList.remove('hidden');
            btn.innerText = currentScreen === 'catalog' 
                ? `–û–§–û–†–ú–ò–¢–¨ (${totalSum} —Å)` 
                : `–ü–û–î–¢–í–ï–†–î–ò–¢–¨ (${totalSum} —Å)`;
        } else {
            btn.classList.add('hidden');
        }
    }

    function handleMainButton() {
        if (currentScreen === 'catalog') showOrderForm();
        else sendDataToBot();
    }

    function showOrderForm() {
        document.getElementById('catalog-screen').style.display = 'none';
        document.getElementById('order-screen').style.display = 'block';
        currentScreen = 'order';
        window.scrollTo(0,0);
        updateUI();
    }

    function showCatalog() {
        document.getElementById('catalog-screen').style.display = 'block';
        document.getElementById('order-screen').style.display = 'none';
        currentScreen = 'catalog';
        updateUI();
    }

    function sendDataToBot() {
        const address = document.getElementById('address').value;
        const phone = document.getElementById('phone').value;
        const kv = document.getElementById('kv').value;
        
        if (!address || !phone) {
            tg.showAlert("‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –∏ —Ç–µ–ª–µ—Ñ–æ–Ω!");
            return;
        }

        let items = [];
        let total = 0;
        for (let key in cart) {
            const i = cart[key];
            const p = products.find(x => x.id == i.id);
            const tName = i.type === 'full' ? '–° –±–∞–ª–ª–æ–Ω–æ–º' : '–° –∑–∞–º–µ–Ω–æ–π –±–∞–ª–ª–æ–Ω–∞';
            items.push({ name: `${p.name} (${tName})`, count: i.count });
            total += i.price * i.count;
        }

        const data = {
            city: document.getElementById('city').value,
            address: address,
            kv: kv,
            phone: phone,
            urgency: document.querySelector('input[name="urgency"]:checked').value,
            payment: document.querySelector('input[name="payment"]:checked').value,
            items: items,
            total: total
        };

        tg.sendData(JSON.stringify(data));
    }
</script>
</body>
</html>
